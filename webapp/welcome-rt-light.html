<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Roaccutane Tracker ‚Äî –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å (Light)</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{
      --bg:#F8FAFB; --card:#FFFFFF; --border:#E6EAF0;
      --text-high:#0F172A; --text-mid:#334155; --text-low:#64748B;
      --primary:#14B8A6;
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text-high);
      background:radial-gradient(60% 50% at 0% 0%, rgba(34,197,94,.22), transparent 60%), radial-gradient(70% 60% at 100% 100%, rgba(236,72,153,.22), transparent 60%), linear-gradient(135deg, #E8F9E9 0%, #FFF6F9 100%);
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Manrope,Helvetica,Arial;
      min-height:100dvh; display:grid; place-items:center;
    }
    .wrap{width:min(1100px,94vw); padding:24px}
    .card{position:relative; overflow:hidden; background:var(--card); border:1px solid var(--border); border-radius:24px; padding:28px 28px 22px; box-shadow:0 10px 30px rgba(2,6,23,.05), 0 2px 8px rgba(2,6,23,.04);}
    .glow{position:absolute; inset:0; pointer-events:none; background:radial-gradient(120% 80% at 10% -10%, rgba(34,197,94,.12), transparent 50%), radial-gradient(120% 80% at 110% 110%, rgba(236,72,153,.12), transparent 50%);}
    .chip{position:absolute; top:max(12px,env(safe-area-inset-top)); right:max(12px,env(safe-area-inset-right)); display:inline-flex; gap:6px; padding:8px 12px; border-radius:999px; font-size:13px; color:var(--text-low); background:#fff; border:1px solid var(--border); box-shadow:0 10px 20px rgba(0,0,0,.06);}
    .row{display:grid; grid-template-columns:180px 1fr; gap:24px; align-items:start}
    .stage{position:relative; width:180px; height:180px; border-radius:18px; border:1px solid var(--border); background:linear-gradient(160deg,#FFFFFF,#F4F7FB); display:grid; place-items:center}
    .pill{width:96px; height:40px} .pill .left{fill:#fff} .pill .right{fill:#f472b6}
    .ring{position:absolute; width:132px; height:132px; border-radius:999px; border:3px solid rgba(34,197,94,.28); animation:r 2.8s ease-out infinite}
    @keyframes r{0%{transform:scale(.85);opacity:.8}80%{transform:scale(1.15);opacity:.08}100%{opacity:0}}
    h1{margin:0 0 6px; font-weight:800; font-size:40px; letter-spacing:.2px}
    p.lead{margin:10px 0 14px; color:var(--text-mid); font-size:20px}

    /* –í–æ–ø—Ä–æ—Å + –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–æ–ª–∏ (–¥–∏–∑–∞–π–Ω –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω–µ) */
    .question{color:var(--text-mid); font-size:18px; margin:10px 0 10px; display:flex; align-items:center; gap:18px; flex-wrap:wrap;}
    .vline{width:2px; height:36px; border-radius:2px; background:#E6EAF0; opacity:.7;}
    .role-options{display:flex; gap:28px; align-items:center; flex-wrap:wrap;}
    .radio{ position:relative; display:inline-flex; align-items:center; gap:10px; padding:10px 14px; border-radius:12px;
             border:1px solid var(--border); background:transparent; color:var(--text-mid); cursor:pointer; user-select:none; }
    .radio input{ position:absolute; inset:0; opacity:0; }
    .radio .dot{ width:14px; height:14px; border-radius:999px; border:2px solid var(--text-mid); display:inline-block; position:relative; }
    .radio input:checked ~ .dot{ border-color:transparent; }
    .radio input:checked ~ .dot::after{ content:''; position:absolute; inset:-2px; border-radius:999px; background:linear-gradient(135deg,#22c55e,#06b6d4,#8b5cf6); }
    .radio input:checked ~ .txt{ color:var(--text-high); font-weight:800; }
    .radio:hover{ border-color:var(--text-mid); }

    /* –ù–∏–∑: –∫–Ω–æ–ø–∫–∏ */
    .footer{display:flex; align-items:center; gap:12px; margin-top:16px; flex-wrap:wrap;}
    .start{appearance:none; border:none; background:linear-gradient(90deg, #22C55E 0%, #EC4899 100%); color:#fff; font-weight:800; padding:12px 18px; border-radius:14px; box-shadow:0 10px 20px rgba(34,197,94,.18), 0 10px 22px rgba(236,72,153,.12); cursor:pointer;}
    .theme{margin-left:auto} .theme button{height:46px; padding:0 18px; border-radius:14px; font-weight:800; background-image: linear-gradient(135deg,#0ea5a6 0%, #0f172a 100%); color:#fff; border:1px solid transparent;}

    @media (max-width:820px){
      h1{font-size:28px}
      .row{grid-template-columns:150px 1fr}
      .stage{width:150px;height:150px}
    }
    @media (max-width:560px){
      .row{grid-template-columns:1fr; gap:16px}
      .stage{width:120px;height:120px; justify-self:start}
      h1{font-size:26px}
      p.lead{font-size:16px}
      .footer .start, .theme button{width:100%}
      .theme{margin-left:0; width:100%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="glow"></div>
      <span class="chip">TG WebApp –≥–æ—Ç–æ–≤</span>

      <div class="row">
        <div class="stage">
          <div class="ring"></div>
          <svg class="pill" viewBox="0 0 200 86" xmlns="http://www.w3.org/2000/svg">
            <defs><clipPath id="capsule"><rect x="0" y="0" rx="43" ry="43" width="200" height="86"/></clipPath></defs>
            <g clip-path="url(#capsule)">
              <rect x="0" y="0" width="100" height="86" fill="#ffffff"/>
              <rect x="100" y="0" width="100" height="86" fill="#f472b6"/>
              <rect x="94" y="0" width="12" height="86" fill="#FFFFFF" opacity=".45"/>
            </g>
            <rect x="0" y="0" rx="43" ry="43" width="200" height="86" fill="none" stroke="rgba(15,23,42,.15)" stroke-width="2"/>
          </svg>
        </div>

        <div>
          <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Roaccutane Tracker</h1>
          <p class="lead">–õ—ë–≥–∫–∞—è –≤–µ—Ä—Å–∏—è: —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ —Å –∑–µ–ª—ë–Ω–æ-—Ä–æ–∑–æ–≤—ã–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º. –§–∏–∫—Å–∏—Ä—É–π—Ç–µ –¥–æ–∑—ã, —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –∏ –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–∏—ë–º.</p>

          <div class="question">
            <span>–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç –ª–∏—Ü–∞ <b>–ø–∞—Ü–∏–µ–Ω—Ç–∞</b> –∏–ª–∏ <b>–≤—Ä–∞—á–∞</b>?</span>
            <span class="vline" aria-hidden="true"></span>
            <div class="role-options" role="radiogroup" aria-label="–í—ã–±–æ—Ä —Ä–æ–ª–∏">
              <label class="radio">
                <input type="radio" name="role" id="roleDoctor" value="doctor">
                <span class="dot"></span>
                <span class="txt">ü©∫ <b>–í—Ä–∞—á</b></span>
              </label>
              <label class="radio">
                <input type="radio" name="role" id="rolePatient" value="patient">
                <span class="dot"></span>
                <span class="txt">üôÇ <b>–ü–∞—Ü–∏–µ–Ω—Ç</b></span>
              </label>
            </div>
          </div>

          <div class="footer">
            <button id="startBtn" class="start">–ù–∞—á–∞—Ç—å</button>
            <div class="theme"><button id="themeToggle">üåô <b>–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</b></button></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const tg = window.Telegram?.WebApp || null;
    tg?.ready?.(); tg?.expand?.();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ –∏–∑ localStorage
    (function(){
      const saved = localStorage.getItem('rt_role') || 'patient';
      const doc = document.getElementById('roleDoctor');
      const pat = document.getElementById('rolePatient');
      if(saved === 'doctor') doc.checked = true; else pat.checked = true;
      document.documentElement.setAttribute('data-role', saved);
      document.querySelectorAll('input[name="role"]').forEach(el=>{
        el.addEventListener('change', () => {
          const role = document.querySelector('input[name="role"]:checked')?.value || 'patient';
          try{ localStorage.setItem('rt_role', role); }catch(_ ){}
          document.documentElement.setAttribute('data-role', role);
          tg?.HapticFeedback?.impactOccurred?.('light');
        });
      });
    })();

    // –°—Ç–∞—Ä—Ç: —Ä–æ—É—Ç–∏–Ω–≥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
    document.getElementById('startBtn').addEventListener('click', () => {
      // A/B routing: first-time vs subsequent visits by role
      const role =
        document.querySelector('input[name="role"]:checked')?.value
        || (document.getElementById('roleSwitch')?.checked ? 'patient' : 'doctor')
        || localStorage.getItem('derma_role')
        || localStorage.getItem('rt_role')
        || 'patient';

      const next = (role === 'doctor')
        ? (localStorage.getItem('rt_doctor_done') === '1'
            ? './doctor-cabinet-mint-rose.html'     // B: subsequent
            : './doctor-onboarding-mint-rose.html') // A: first time
        : (localStorage.getItem('rt_patient_done') === '1'
            ? './main-dark.html'                    // B: subsequent
            : './profile-dark.html');               // A: first time

      location.replace(next);
    }, { once: true });

    // –°–º–µ–Ω–∞ —Ç–µ–º—ã
    (function(){
      const btn = document.getElementById('themeToggle');
      if(!btn) return;
      const qs = location.search || '';
      btn.addEventListener('click', ()=> {
        try{ localStorage.setItem('rt_theme','dark'); }catch(_ ){}
        location.replace('./welcome-rt.html'+ qs);
      });
    })();
  </script>
</body>
</html>

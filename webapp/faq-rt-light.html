<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <script>try{ if(localStorage.getItem('derma_consent')!=='1'){ location.replace('./warnings.html'); } }catch(_){}</script>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Roaccutane Tracker — FAQ (Light)</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>window.API_BASE = window.API_BASE || '';</script>
  <style>
    :root{
      --bg:#0B1220; --surface:#0E1726; --card:#121C2E; --border:#1F2A3C;
      --primary:#14B8A6; --primary-700:#0EA5A6; --primary-300:#5EEAD4;
      --info:#60A5FA; --success:#22C55E; --warning:#F59E0B; --danger:#EF4444;
      --text-high:#F3F7FF; --text-mid:#C7D2FE; --text-low:#93A3BF; --focus-ring:#93C5FD;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text-high);
         font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Manrope,Helvetica,Arial;
         font-size:16px;line-height:1.5}
    .wrap{max-width:980px;margin:0 auto;padding:24px 24px 40px}
    h1{font-size:28px;line-height:34px;margin:0 0 16px;font-weight:600}
    h2{font-size:22px;line-height:28px;margin:0 0 12px;font-weight:600}
    .card{position:relative;background:var(--card);border:1px solid var(--border);border-radius:16px;
          padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.35);overflow:hidden}
    .glow{position:absolute;inset:0;pointer-events:none;background:radial-gradient(120% 120% at 10% 0%, rgba(20,184,166,.18) 0%, rgba(18,28,46,0) 50%)}
    .muted{color:var(--text-low)}
    input[type="search"]{
      width:100%;background:var(--surface);border:1px solid var(--border);color:var(--text-high);
      border-radius:12px;padding:10px 12px;font-size:16px;outline:none
    }
    input[type="search"]:focus{border-color:var(--primary-700);box-shadow:0 0 0 2px var(--focus-ring)}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:999px;background:#152235;border:1px solid transparent;color:var(--text-high);font-weight:600;margin-right:8px;margin-bottom:8px;text-decoration:none}
    .chip:hover{border-color:#14B8A6;cursor:pointer}
    details{border:1px solid var(--border);border-radius:12px;background:#0E1726;margin:10px 0;overflow:hidden}
    details[open]{border-color:#0EA5A6;box-shadow:0 0 0 2px rgba(20,184,166,.25) inset}
    summary{display:flex;gap:10px;align-items:center;list-style:none;padding:12px 14px;cursor:pointer;font-weight:600}
    summary::-webkit-details-marker{display:none}
    .qa-body{padding:0 14px 12px;color:var(--text-high)}
    .qa-body p{margin:8px 0}
    .pill{display:inline-flex;align-items:center;border:1px solid #2a3a52;border-radius:999px;padding:2px 8px;font-size:12px;margin-left:8px;color:var(--text-mid);background:#0f1a2b}
    a{color:var(--text-mid);text-decoration:underline;text-underline-offset:3px}
    footer{margin:24px 0 8px;color:var(--text-low);text-align:center;font-size:13px}
  
    /* === Light theme (green + peach) === */
    :root{
      --bg:#F8FAFB; --card:#FFFFFF; --border:#E6EAF0;
      --text-high:#0F172A; --text-mid:#334155; --text-low:#64748B;
      --primary-700:#0EA5A6;
    }
    body{
      color:var(--text-high);
      background:
        radial-gradient(60% 50% at 0% 0%, rgba(34,197,94,.18), transparent 60%),
        radial-gradient(70% 60% at 100% 100%, rgba(253,178,142,.22), transparent 60%),
        linear-gradient(135deg, #E8F9E9 0%, #FFF3EC 100%) !important;
    }
    .card{ background:var(--card) !important; border:1px solid var(--border) !important; box-shadow: 0 10px 30px rgba(2,6,23,.05), 0 2px 8px rgba(2,6,23,.04) !important; }
    .muted{ color:var(--text-low) !important }
    .chip-link{ background:#F1F5F9 !important; border:1px solid var(--border) !important; color:var(--text-high) !important }
    details{ background:#FBFDFE !important; border:1px solid var(--border) !important }
    details[open]{ border-color: rgba(14,165,166,.6) !important; box-shadow: 0 0 0 3px rgba(14,165,166,.12) inset !important }
    .search{ background:#fff !important; border:1px solid var(--border) !important; color:var(--text-high) !important }
    .nav a{ background:#FFFFFF !important; border:1px solid var(--border) !important; color:var(--text-mid) !important; }
    .chip{ background:#fff !important; border:1px solid var(--border) !important; color:var(--text-low) !important; }
    .topbar{display:flex;align-items:center;gap:12px;flex-wrap:wrap;margin:8px 0 12px}
    .back-btn{
      display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;
      background:#FFFFFF;border:1px solid var(--border);color:var(--text-mid);text-decoration:none;font-weight:700;
      box-shadow:0 6px 16px rgba(2,6,23,.04);transition:all .15s ease-in-out
    }
    .back-btn:hover{border-color: rgba(14,165,166,.6); color:var(--text-high); transform: translateY(-1px)}
    .back-btn svg{width:18px;height:18px;opacity:.9}

  
    /* Персиковые бейджи (pill) с хорошей читаемостью текста */
    .pill{
      background: linear-gradient(180deg, #FFF1EA 0%, #FFE6D7 100%) !important;
      border: 1px solid #F7C9B0 !important;
      color: #0F172A !important; /* тёмный текст для контраста */
    }

  
    /* Персиковое поле поиска */
    .search{
      background: linear-gradient(180deg, #FFF1EA 0%, #FFE6D7 100%) !important;
      border: 1px solid #F7C9B0 !important;
      color: #0F172A !important;
    }
    .search::placeholder{ color:#475569 !important; opacity:.9 }
    .search:focus{ border-color: rgba(14,165,166,.6) !important; box-shadow: 0 0 0 3px rgba(14,165,166,.18) }

  
    /* === Персиковое поле поиска (форсируем стиль высокой специфичностью) === */
    .card .search,
    .wrap .search,
    input.search[type="search"]{
      -webkit-appearance:none; appearance:none;
      background: linear-gradient(180deg, #FFF1EA 0%, #FFE6D7 100%) !important;
      background-clip: padding-box;
      border: 1px solid #F7C9B0 !important;
      color: #0F172A !important;
      caret-color: #0F172A !important;
      box-shadow: 0 2px 10px rgba(2,6,23,.05) !important;
    }
    .card .search::placeholder,
    .wrap .search::placeholder,
    input.search[type="search"]::placeholder{ color:#475569 !important; opacity:.95 }
    .card .search:focus,
    .wrap .search:focus,
    input.search[type="search"]:focus{ border-color: rgba(14,165,166,.6) !important; box-shadow: 0 0 0 3px rgba(14,165,166,.18) !important; outline:none }
    /* Автофилл в браузерах WebKit */
    input.search[type="search"]:-webkit-autofill{
      -webkit-box-shadow: 0 0 0 1000px #FFEDE2 inset !important;
      -webkit-text-fill-color: #0F172A !important;
    }

  </style>

  <style>
  /* === Exact-look Theme Toggle === */
  .topbar { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
  #themeToggle{ margin-left:auto; }

  #themeToggle.theme-toggle{
    --h:88px; --w:260px; --pad:10px; --bd:2px;
    --thumb:calc(var(--h) - 2*(var(--pad) + var(--bd)));
    position:relative; width:var(--w); height:var(--h);
    padding:0; border:var(--bd) solid #D7E0E2; border-radius:999px;
    background:#F4F8F9; cursor:pointer; overflow:hidden;
    -webkit-tap-highlight-color:transparent;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.65);
  }
  html[data-theme="dark"] #themeToggle.theme-toggle{
    background:#0F1726;
    border-color: rgba(255,255,255,.06);
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.05);
  }
  #themeToggle .scene{
    position:absolute; inset:var(--pad); border-radius:calc(var(--h)/2 - var(--pad));
    overflow:hidden; pointer-events:none;
    transition: opacity .28s ease, transform .38s cubic-bezier(.2,.7,.2,1);
  }
  #themeToggle .scene svg{ position:absolute; inset:0; width:100%; height:100%; display:block; }
  #themeToggle .scene.light{ opacity:1; }
  #themeToggle .scene.dark{ opacity:0; }

  html[data-theme="dark"] #themeToggle .scene.light{ opacity:0; transform: translateX(-6px); }
  html[data-theme="dark"] #themeToggle .scene.dark { opacity:1; transform: translateX(0); }

  /* Thumb */
  #themeToggle .thumb{
    position:absolute; top:calc(var(--pad) + var(--bd)); left:calc(var(--pad) + var(--bd));
    width:var(--thumb); height:var(--thumb); border-radius:50%;
    background:#FFFFFF;
    box-shadow: 0 10px 28px rgba(0,0,0,.25),
                inset 0 0 0 1px rgba(0,0,0,.08),
                inset 0 1px 0 rgba(0,0,0,.06);
    transform: translateX(0);
    transition: transform .38s cubic-bezier(.2,.7,.2,1);
    z-index:3;
  }
  html[data-theme="dark"] #themeToggle .thumb{
    transform: translateX(calc(var(--w) - 2*(var(--pad) + var(--bd)) - var(--thumb)));
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce){
    #themeToggle .thumb, #themeToggle .scene{ transition:none !important; }
  }
  </style>
    

  <style>
    /* --- Invert toggle visuals: show DARK scene on LIGHT page, and LIGHT scene on DARK page --- */
    html[data-theme="light"] #themeToggle.theme-toggle .scene.light{ opacity:0; transform: translateX(-6px); }
    html[data-theme="light"] #themeToggle.theme-toggle .scene.dark { opacity:1; transform: translateX(0); }
    html[data-theme="dark"]  #themeToggle.theme-toggle .scene.light{ opacity:1; transform: translateX(0); }
    html[data-theme="dark"]  #themeToggle.theme-toggle .scene.dark { opacity:0; transform: translateX(6px); }
    /* Invert thumb mapping too: on LIGHT page thumb on the RIGHT, on DARK page on the LEFT */
    #themeToggle.theme-toggle .thumb{ transform: translateX(0); }
    html[data-theme="light"] #themeToggle.theme-toggle .thumb{
      transform: translateX(calc(var(--w) - 2*(var(--pad) + var(--bd)) - var(--thumb)));
    }
    html[data-theme="dark"] #themeToggle.theme-toggle .thumb{ transform: translateX(0); }
  </style>
    

  <script>
    (function(){
      try{ if('scrollRestoration' in history) history.scrollRestoration = 'manual'; }catch(_){}
      var toTop = function(){ try{
        document.documentElement.scrollTop = 0;
        document.body.scrollTop = 0;
        window.scrollTo(0,0);
      }catch(_){} };
      if(document.readyState === 'complete' || document.readyState === 'interactive'){
        toTop();
      }else{
        window.addEventListener('DOMContentLoaded', toTop, {once:true});
      }
      window.addEventListener('pageshow', function(){ toTop(); }, {once:true});
    })();
  </script>


  <style>
    /* Ensure the back button is not overlapped by the toggle */
    .topbar .back-btn{ position:relative; z-index: 20; }
    #themeToggle.theme-toggle{ position:relative; z-index: 10; }
  </style>

</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <a class="back-btn" href="./main-light.html" id="btn-back" aria-label="Назад на главную">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <span>Назад</span>
      </a>
      <h1 style="margin:0">Roaccutane Tracker</h1>

      <!-- Theme toggle exact -->
      <button id="themeToggle" class="theme-toggle" role="switch" aria-checked="false" aria-label="Переключить тему">
        <span class="scene light">
      <svg viewBox="0 0 260 88" xmlns="http://www.w3.org/2000/svg">
        <!-- gradient sky -->
        <defs>
          <linearGradient id="lgLight" x1="0" y1="0" x2="1" y2="0">
            <stop offset="0%" stop-color="#5ECFC8"/>
            <stop offset="100%" stop-color="#FFD3A3"/>
          </linearGradient>
        </defs>
        <rect x="0" y="0" width="260" height="88" rx="34" fill="url(#lgLight)"/>
        <!-- clouds (creamy) -->
        <g fill="#FFF1E2">
          <g opacity=".85">
            <circle cx="170" cy="46" r="18"/>
            <circle cx="188" cy="46" r="22"/>
            <circle cx="209" cy="50" r="18"/>
          </g>
          <g opacity=".35">
            <circle cx="130" cy="54" r="10"/>
            <circle cx="145" cy="56" r="12"/>
          </g>
        </g>
      </svg>
    </span>
        <span class="scene dark">
      <svg viewBox="0 0 260 88" xmlns="http://www.w3.org/2000/svg">
        <!-- gradient night -->
        <defs>
          <linearGradient id="lgDark" x1="0" y1="0" x2="1" y2="0">
            <stop offset="0%" stop-color="#1C2140"/>
            <stop offset="100%" stop-color="#2A0F4A"/>
          </linearGradient>
        </defs>
        <rect x="0" y="0" width="260" height="88" rx="34" fill="url(#lgDark)"/>
        <!-- rings on right -->
        <g opacity=".55" mix-blend-mode="multiply">
          <ellipse cx="230" cy="44" rx="58" ry="44" fill="rgba(0,0,0,.22)"/>
        </g>
        <g opacity=".38" mix-blend-mode="multiply">
          <ellipse cx="236" cy="44" rx="82" ry="60" fill="rgba(0,0,0,.15)"/>
        </g>
        <!-- clouds (violet) -->
        <g fill="#3B2A6B">
          <g opacity=".75">
            <circle cx="86" cy="52" r="22"/>
            <circle cx="110" cy="50" r="18"/>
            <circle cx="132" cy="54" r="22"/>
          </g>
          <g opacity=".40">
            <circle cx="46" cy="56" r="18"/>
            <circle cx="64" cy="56" r="14"/>
          </g>
        </g>
        <!-- stars -->
        <g fill="#A98DF7" opacity=".8">
          <circle cx="136" cy="18" r="1.8"/>
          <circle cx="152" cy="24" r="1.4"/>
          <circle cx="170" cy="20" r="1.3"/>
          <circle cx="186" cy="28" r="1.6"/>
          <circle cx="200" cy="22" r="1.2"/>
        </g>
      </svg>
    </span>
        <span class="thumb"></span>
      </button>
    

    </div>
    <h1>Derma Mini‑App</h1>

    <section class="card" aria-labelledby="faq-title">
      <div class="glow"></div>
      <h2 id="faq-title">FAQ — часто задаваемые вопросы</h2>
      <div class="muted" style="margin-bottom:8px">Эта информация носит справочный характер и не заменяет консультацию врача.</div>

      <input id="search" type="search" placeholder="Поиск по FAQ (нажмите / для фокуса)">
      <div style="margin-top:10px">
        <a class="chip" href="#start">Начало</a>
        <a class="chip" href="#dose">Дозировка</a>
        <a class="chip" href="#side">Побочные эффекты</a>
        <a class="chip" href="#labs">Анализы</a>
        <a class="chip" href="#pregnancy">Беременность</a>
        <a class="chip" href="#alcohol">Алкоголь</a>
        <a class="chip" href="#sun">Солнце</a>
        <a class="chip" href="#interactions">Лекарства</a>
        <a class="chip" href="#missed">Пропуск дозы</a>
        <a class="chip" href="#app">Приложение</a>
      </div>
    </section>

    <section class="card" aria-label="Популярные вопросы">
      <div class="glow"></div>
      <h2 style="margin-bottom:6px">Популярные вопросы и нюансы</h2>

      <div id="qa-list">

        <details class="qa" id="start">
          <summary>Как начать курс и работать с приложением? <span class="pill">start</span></summary>
          <div class="qa-body">
            <p>1) Прочитайте «Безопасность и согласие» и подтвердите, 2) заполните <a href="/profile">Профиль</a> (вес обязателен), 3) задайте <a href="/plan">План курса</a>, 4) отмечайте приём на Главной. Если что‑то изменилось — отредактируйте соответствующую страницу.</p>
          </div>
        </details>

        <details class="qa" id="dose">
          <summary>Какая целевая кумулятивная доза? Как её считать? <span class="pill">dose</span></summary>
          <div class="qa-body">
            <p>Обычно ориентируются на диапазон <b>120–150 мг/кг</b>, оптимум — <b>≈135 мг/кг</b>. Приложение считает процент, исходя из вашего веса и суммарно выпитых мг (включая уже выпитое, если вы его указали).</p>
          </div>
        </details>

        <details class="qa" id="food">
          <summary>Нужно ли принимать капсулы с едой? <span class="pill">биодоступность</span></summary>
          <div class="qa-body">
            <p>Да, <b>с едой, содержащей жир</b> — так изотретиноин лучше всасывается. Если врач сказал иначе — следуйте его плану.</p>
          </div>
        </details>

        <details class="qa" id="labs">
          <summary>Как часто сдавать анализы? <span class="pill">анализы</span></summary>
          <div class="qa-body">
            <p>Часто назначают контроль <b>каждые ~4 недели</b> (АЛТ/АСТ, билирубин, липиды и др.). Точный перечень и частоту определяет лечащий врач.</p>
          </div>
        </details>

        <details class="qa" id="missed">
          <summary>Пропустил(а) дозу — что делать? <span class="pill">пропуск</span></summary>
          <div class="qa-body">
            <p>Если вспомнили в тот же день — примите, если близко ко времени следующей — <b>пропустите</b> и продолжайте как обычно. <b>Не удваивайте</b> дозу.</p>
          </div>
        </details>

        <details class="qa" id="side">
          <summary>Сухость губ и кожи — чем помочь? <span class="pill">побочки</span></summary>
          <div class="qa-body">
            <p>Бальзам с вазелином/ланолином для губ, нежные увлажняющие кремы без кислот и ретиноидов, физиологические промывки носа/увлажнение воздуха. Избегайте агрессивных пилингов и скрабов.</p>
          </div>
        </details>

        <details class="qa" id="sport">
          <summary>Боль в мышцах/суставах на курсе <span class="pill">спорт</span></summary>
          <div class="qa-body">
            <p>Снизьте интенсивность нагрузок, уделяйте внимание восстановлению. Если боль выраженная или нарастает — обсудите с врачом коррекцию дозы/паузы.</p>
          </div>
        </details>

        <details class="qa" id="redflags">
          <summary>Изменения настроения, головные боли, ухудшение зрения <span class="pill">важно</span></summary>
          <div class="qa-body">
            <p>Это <b>важные сигналы</b>. Срочно свяжитесь с врачом. При резком ухудшении самочувствия — обратитесь за неотложной помощью.</p>
          </div>
        </details>

        <details class="qa" id="pregnancy">
          <summary>Беременность и контрацепция на изотретиноине <span class="pill">тератогенность</span></summary>
          <div class="qa-body">
            <p>Изотретиноин <b>тератогенен</b>. Нельзя беременеть во время курса и в течение <b>минимум 1 месяца</b> после. Требуется надёжная контрацепция и отрицательные тесты — следуйте схеме врача. <b>Донорство крови запрещено</b> на курсе и месяц после.</p>
          </div>
        </details>

        <details class="qa" id="alcohol">
          <summary>Можно ли алкоголь? <span class="pill">алкоголь</span></summary>
          <div class="qa-body">
            <p>Желательно <b>избегать</b>: алкоголь повышает нагрузку на печень и может усиливать рост триглицеридов. Если планируете — обсудите с врачом индивидуальные риски.</p>
          </div>
        </details>

        <details class="qa" id="sun">
          <summary>Солнце и SPF <span class="pill">фотосенсибилизация</span></summary>
          <div class="qa-body">
            <p>Кожа становится чувствительнее к ультрафиолету. Ежедневно используйте <b>SPF 30+</b>, шляпу/очки, избегайте соляриев.</p>
          </div>
        </details>

        <details class="qa" id="interactions">
          <summary>Какие лекарства и добавки несовместимы? <span class="pill">взаимодействия</span></summary>
          <div class="qa-body">
            <p>Не сочетайте с добавками <b>витамина A</b> и другими <b>ретиноидами</b> (наружными/системными). Совместное применение с <b>тетрациклинами</b> может повышать риск внутричерепной гипертензии — обычно избегают.</p>
          </div>
        </details>

        <details class="qa" id="procedures">
          <summary>Процедуры: лазер, пилинг, восковая эпиляция <span class="pill">процедуры</span></summary>
          <div class="qa-body">
            <p>Во время курса и некоторое время после (часто рекомендуют до <b>6 месяцев</b>) избегают травмирующих процедур из‑за риска рубцевания/гиперпигментации. Сроки — только с врачом.</p>
          </div>
        </details>

        <details class="qa" id="lenses">
          <summary>Контактные линзы и сухость глаз <span class="pill">линзы</span></summary>
          <div class="qa-body">
            <p>Возможна сухость глаз. Используйте «искусственные слёзы», делайте перерывы, при выраженном дискомфорте временно переходят на очки.</p>
          </div>
        </details>

        <details class="qa" id="finish">
          <summary>Когда заканчивают курс? <span class="pill">окончание</span></summary>
          <div class="qa-body">
            <p>Обычно — когда достигнута кумулятивная цель и стойкая ремиссия. Решение принимает врач с учётом клиники и переносимости.</p>
          </div>
        </details>

        <details class="qa" id="brands">
          <summary>Роаккутан, Акнеккутан — в чём разница? <span class="pill">бренды</span></summary>
          <div class="qa-body">
            <p>Это торговые названия <b>изотретиноина</b> от разных производителей. В приложении выбор влияет на быстрые чипы доз (кратные 10 мг или 8 мг).</p>
          </div>
        </details>

        <details class="qa" id="app">
          <summary>Как отмечать приём и где смотреть статистику в приложении? <span class="pill">app</span></summary>
          <div class="qa-body">
            <p>На <a href="./main-light.html">Главной</a> введите мг и дату, нажмите «Сохранить» или выберите чип дозы. Сводные метрики, процент к 135 мг/кг и ETA — в блоке «Прогресс». Последние отметки и календарь‑превью — ниже.</p>
          </div>
        </details>

      </div>
    </section>

    <section class="card" aria-label="Навигация">
      <div class="glow"></div>
      <div class="row" style="justify-content:space-between">
        <a href="./main-light.html">← На главную</a>
        <a href="/profile">Профиль</a>
      </div>
    </section>

    <footer>Информация носит общий характер и не заменяет консультацию врача. При любых ухудшениях — обратитесь к специалисту.</footer>
  </div>

  <script>
    const tgApp=(window.Telegram&&window.Telegram.WebApp)?window.Telegram.WebApp:null;
    if(tgApp&&tgApp.ready) tgApp.ready();
    if(tgApp&&tgApp.expand) tgApp.expand();

    const inp=document.getElementById('search');
    const items=[...document.querySelectorAll('#qa-list .qa')];
    function applyFilter(){
      const q=(inp.value||'').toLowerCase().trim();
      items.forEach(el=>{
        if(!q){ el.style.display=''; return; }
        const text=el.textContent.toLowerCase();
        el.style.display = text.includes(q) ? '' : 'none';
      });
    }
    inp.addEventListener('input', applyFilter);
    window.addEventListener('keydown', (e)=>{ if(e.key==='/'){ e.preventDefault(); inp.focus(); } });

    function openByHash(){
      const id=location.hash.replace('#','');
      if(!id) return;
      const el=document.getElementById(id);
      if(el && el.tagName.toLowerCase()==='details'){ el.open=true; el.scrollIntoView({behavior:'smooth', block:'start'}); }
    }
    window.addEventListener('hashchange', openByHash);
    openByHash();

const back=document.getElementById('btn-back');if(back){back.addEventListener('click',e=>{e.preventDefault();try{if(history.length>1){history.back();return;}}catch(_){}location.href='./main-light.html';});}
  </script>

  <script>
  (function(){
    const PAGES = { light: 'faq-rt-light.html', dark: 'faq.html' };
    const btn = document.getElementById('themeToggle');
    if(!btn) return;

    const isLight = /faq-rt-light\.html$/i.test(location.pathname) || /\(Light\)/.test(document.title);
    setTheme(isLight ? 'light' : 'dark', true);
    btn.setAttribute('aria-checked', String(!isLight));

    btn.addEventListener('click', toggle);
    btn.addEventListener('keydown', (e)=>{
      if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); toggle(); }
    });

    function toggle(){
      const next = (document.documentElement.dataset.theme === 'dark') ? 'light' : 'dark';
      setTheme(next);
      try{ localStorage.setItem('rt.theme', next); }catch(_){}
      const target = PAGES[next];
      const hash = location.hash || '';
      if(target && !location.pathname.endsWith('/'+target)){
        location.href = target;
      }
    }
    function setTheme(t, silent){
      document.documentElement.setAttribute('data-theme', t);
      if(!silent){ document.dispatchEvent(new CustomEvent('themechange', {detail:t})); }
    }

    // honor saved theme if user lands directly
    try{
      const saved = localStorage.getItem('rt.theme');
      if(saved && saved !== (isLight?'light':'dark')){
        setTheme(saved, true);
        const target = PAGES[saved];
        if(target && !location.pathname.endsWith('/'+target)){
          location.replace(target);
        }
      }
    }catch(_){}
  })();
  </script>
    

<script>
(function(){
  var back = document.getElementById('btn-back');
  if(!back) return;
  back.addEventListener('click', function(e){
    // Prevent any bubbling that could hit other handlers
    e.stopPropagation();
    // Let anchor navigate, but ensure it always points to correct main page for current theme
    var t = document.documentElement.dataset.theme || 'dark';
    var target = (t === 'dark') ? './main-dark.html' : './main-light.html';
    if (back.getAttribute('href') !== target) back.setAttribute('href', target);
    // no preventDefault -> allow native navigation
  }, {capture:true});
})();
</script>

</body>
</html>
